---
goal: Implement Scalar for Interactive API Documentation
version: 1.0
date_created: 2025-09-29
last_updated: 2025-09-29
owner: Development Team
status: Planned
tags: feature, api, documentation
---

# Introduction

![Status: Planned](https://img.shields.io/badge/status-Planned-blue)

This implementation plan outlines the steps to adopt Scalar as the primary interactive API documentation tool for the Patient Health Record application, replacing the current Swagger UI implementation as approved in ADR 003.

## 1. Requirements & Constraints

- **REQ-001**: Replace Swagger UI with Scalar for improved developer experience
- **REQ-002**: Maintain OpenAPI document generation compatibility
- **REQ-003**: Enable Scalar only in development environment
- **CON-001**: Must not affect production builds or expose API docs in production
- **CON-002**: Preserve existing FastEndpoints configuration except SwaggerDocument
- **GUD-001**: Follow ASP.NET Core best practices for middleware configuration
- **PAT-001**: Use conditional configuration based on environment

## 2. Implementation Steps

### Implementation Phase 1: Install Scalar Package

- GOAL-001: Add Scalar.AspNetCore dependency to the project

| Task | Description | Completed | Date |
|------|-------------|-----------|------|
| TASK-001 | Run `dotnet add package Scalar.AspNetCore` in PatientHealthRecord.Web project directory |  |  |
| TASK-002 | Verify package installation by checking csproj file for Scalar.AspNetCore reference |  |  |

### Implementation Phase 2: Update Program.cs Configuration

- GOAL-002: Configure Scalar middleware and remove Swagger UI

| Task | Description | Completed | Date |
|------|-------------|-----------|------|
| TASK-003 | Locate Program.cs in src/PatientHealthRecord.Web/Program.cs |  |  |
| TASK-004 | Add `using Scalar.AspNetCore;` directive at the top of Program.cs |  |  |
| TASK-005 | Add conditional Scalar configuration: `if (app.Environment.IsDevelopment()) { app.MapScalarApiReference(); }` after FastEndpoints configuration |  |  |
| TASK-006 | Remove or comment out the `.SwaggerDocument(o => { o.ShortSchemaNames = true; })` call from FastEndpoints configuration |  |  |

### Implementation Phase 3: Update Launch Settings

- GOAL-003: Configure development launch URL for direct Scalar access

| Task | Description | Completed | Date |
|------|-------------|-----------|------|
| TASK-007 | Locate Properties/launchSettings.json in src/PatientHealthRecord.Web/Properties/launchSettings.json |  |  |
| TASK-008 | Update the "launchUrl" property to "scalar" in the development profile |  |  |

### Implementation Phase 4: Test and Validate

- GOAL-004: Verify Scalar integration works correctly

| Task | Description | Completed | Date |
|------|-------------|-----------|------|
| TASK-009 | Build the application to ensure no compilation errors |  |  |
| TASK-010 | Run the application in development mode and navigate to /scalar |  |  |
| TASK-011 | Verify Scalar UI loads and displays API documentation |  |  |
| TASK-012 | Test API endpoints through Scalar interface |  |  |
| TASK-013 | Confirm Swagger UI is no longer accessible |  |  |

## 3. Alternatives

- **ALT-001**: Keep Swagger UI alongside Scalar - Rejected due to maintenance overhead and UI confusion
- **ALT-002**: Use Redoc instead of Scalar - Rejected as Scalar provides better integration with ASP.NET Core
- **ALT-003**: Implement Scalar in production - Rejected due to security concerns

## 4. Dependencies

- **DEP-001**: Scalar.AspNetCore NuGet package
- **DEP-002**: Existing Microsoft.AspNetCore.OpenApi package for OpenAPI generation
- **DEP-003**: FastEndpoints framework for API routing

## 5. Files

- **FILE-001**: src/PatientHealthRecord.Web/PatientHealthRecord.Web.csproj - Add Scalar package reference
- **FILE-002**: src/PatientHealthRecord.Web/Program.cs - Update middleware configuration
- **FILE-003**: src/PatientHealthRecord.Web/Properties/launchSettings.json - Update launch URL

## 6. Testing

- **TEST-001**: Manual verification of Scalar UI loading in development
- **TEST-002**: Functional testing of API endpoints through Scalar interface
- **TEST-003**: Regression testing to ensure no API functionality is broken
- **TEST-004**: Build verification to ensure no compilation issues

## 7. Risks & Assumptions

- **RISK-001**: Scalar package may have compatibility issues with ASP.NET Core 9 - Mitigation: Test thoroughly in development
- **ASSUMPTION-001**: OpenAPI documents are correctly generated by existing configuration
- **ASSUMPTION-002**: Development team can adapt to Scalar's interface

## 8. Related Specifications / Further Reading

- [ADR 003: Adopt Scalar for Interactive API Documentation](docs/architecture/decisions/adr-003-scalar-api-documentation.md)
- [Scalar ASP.NET Core Integration Guide](https://guides.scalar.com/scalar/scalar-api-references/integrations/net-aspnet-core/integration)
- [Microsoft ASP.NET Core OpenAPI Documentation](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/openapi/using-openapi-documents?view=aspnetcore-9.0)
